{"version":3,"sources":["start.js"],"names":["tiago","utils","isTT","init","appId","debug","then","console","log","catch","err","cc","Class","extends","Component","properties","labelNickName","Label","spriteAvatar","Sprite","start","dataManager","selfUserInfo","renderSelf","info","string","nickName","renderAvatar","avatarUrl","onClickGetConfig","BUSINESS_SCENE","config","getConfig","currentScene","scene","LiveRoom","params","isAIRequired","Wonderland","onClickGetUserInfo","getUserInfo","onClickStartSingleMatch","match","startSingleMatch","on","result","room","joinGameRoom","roomNum","joinRTCForGameRoom","roomManager","loadRoom","error"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAIA,gBAAMC,KAAN,CAAYC,IAAZ,EAAJ,EAAwB;AACpBF,oBAAMG,IAAN,CAAW;AACPC,eAAO,oBADA;AAEPC,eAAO;AAFA,KAAX,EAGGC,IAHH,CAGQ,YAAM;AACVC,gBAAQC,GAAR,CAAY,qBAAZ;AACH,KALD,EAKGC,KALH,CAKS,eAAO;AACZF,gBAAQC,GAAR,CAAYE,GAAZ;AACA;AACH,KARD;AASH;;AAEDC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,uBAAeL,GAAGM,KADV;AAERC,sBAAcP,GAAGQ;AAFT,KAHP;;AAQLC,SARK,mBAQI;AACL,YAAIC,uBAAYC,YAAhB,EAA8B;AAC1B,iBAAKC,UAAL,CAAgBF,uBAAYC,YAA5B;AACH;AACJ,KAZI;AAcLC,cAdK,sBAcMC,IAdN,EAcY;AACb,aAAKR,aAAL,CAAmBS,MAAnB,GAA4BD,KAAKE,QAAjC;AACAzB,wBAAM0B,YAAN,CAAmB,KAAKT,YAAxB,EAAsCM,KAAKI,SAA3C;AACH,KAjBI;AAmBLC,oBAnBK,8BAmBc;AAAA,YACPC,cADO,GACY9B,eADZ,CACP8B,cADO;;;AAGf,YAAMC,SAAS/B,gBAAMgC,SAAN,EAAf;AACAzB,gBAAQC,GAAR,CAAYuB,MAAZ;;AAJe,YAMPE,YANO,GAMiBF,MANjB,CAMPE,YANO;AAAA,YAMOC,KANP,GAMiBH,MANjB,CAMOG,KANP;;;AAQf,YAAID,iBAAiBH,eAAeK,QAApC,EAA8C;AAC1C;AACA,gBAAMC,SAASF,MAAMD,YAAN,CAAf;;AAEA,gBAAIG,OAAOC,YAAX,EAAyB,CAExB;AADG;;;AAGJ;AACH,SATD,MASO,IAAIJ,iBAAiBH,eAAeQ,UAApC,EAAgD;AACnD;AACH;AACJ,KAvCI;AAyCLC,sBAzCK,gCAyCgB;AACjB,YAAMf,OAAOxB,gBAAMwC,WAAN,EAAb;AACAjC,gBAAQC,GAAR,CAAYgB,IAAZ;;AAEA;AACAH,+BAAYC,YAAZ,GAA2BE,IAA3B;AACA,aAAKD,UAAL,CAAgBF,uBAAYC,YAA5B;AACH,KAhDI;AAkDLmB,2BAlDK,qCAkDqB;AACtB,YAAMC,QAAQ1C,gBAAM2C,gBAAN,EAAd;;AAEAD,cAAME,EAAN,CAAS,eAAT,EAA0B,kBAAU;AAChC;AACArC,oBAAQC,GAAR,CAAYqC,MAAZ;AACH,SAHD;;AAKAH,cAAME,EAAN,CAAS,0BAAT,EAAqC,kBAAU;AAC3CrC,oBAAQC,GAAR,CAAYqC,MAAZ;;AAEA;AACA,gBAAMC,OAAO9C,gBAAM+C,YAAN,CAAmB;AAC5BC,yBAASH,OAAOG;AADY,aAAnB,CAAb;;AAIA;AACAhD,4BAAMiD,kBAAN,CAAyBH,IAAzB;;AAEA;AACAI,mCAAYC,QAAZ,CAAqBL,IAArB;AACH,SAbD;;AAeAJ,cAAME,EAAN,CAAS,OAAT,EAAkB,iBAAS;AACvBrC,oBAAQC,GAAR,CAAY4C,KAAZ;AACH,SAFD;AAGH;AA5EI,CAAT","file":"start.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["import tiago from '@byted-creative/tiago';\nimport roomManager from './room_manager';\nimport dataManager from './data_manager';\nimport utils from './utils';\n\nif (tiago.utils.isTT()) {\n    tiago.init({\n        appId: 'tt5e982825c1b2d9a3',\n        debug: true,\n    }).then(() => {\n        console.log('tiago init success.');\n    }).catch(err => {\n        console.log(err);\n        // NOTE: 一般情况不会出错，我们会对错误情况做监控，游戏可以处理一些异常情况下的表现\n    });\n}\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        labelNickName: cc.Label,\n        spriteAvatar: cc.Sprite,\n    },\n\n    start () {\n        if (dataManager.selfUserInfo) {\n            this.renderSelf(dataManager.selfUserInfo);\n        }\n    },\n\n    renderSelf(info) {\n        this.labelNickName.string = info.nickName;\n        utils.renderAvatar(this.spriteAvatar, info.avatarUrl);\n    },\n\n    onClickGetConfig() {\n        const { BUSINESS_SCENE } = tiago;\n\n        const config = tiago.getConfig();\n        console.log(config);\n\n        const { currentScene, scene } = config;\n\n        if (currentScene === BUSINESS_SCENE.LiveRoom) {\n            // 当前是直播场景\n            const params = scene[currentScene];\n\n            if (params.isAIRequired) {  \n                // NOTE: 补充 AI 逻辑\n            }\n            \n            // NOTE: 针对直播场景，调整使用直播专用的 UI，或处理其他特殊逻辑\n        } else if (currentScene === BUSINESS_SCENE.Wonderland) {\n            // 当前是 W 场景\n        }\n    },\n\n    onClickGetUserInfo() {\n        const info = tiago.getUserInfo();\n        console.log(info);\n\n        // NOTE: 这里只是简单的保存下来\n        dataManager.selfUserInfo = info;\n        this.renderSelf(dataManager.selfUserInfo);\n    },\n\n    onClickStartSingleMatch() {\n        const match = tiago.startSingleMatch();\n\n        match.on('match-success', result => {\n            // 获得匹配成功后的用户信息\n            console.log(result);\n        });\n        \n        match.on('create-game-room-success', result => {\n            console.log(result);\n\n            // NOTE: 随后可以加入游戏房间\n            const room = tiago.joinGameRoom({\n                roomNum: result.roomNum,\n            });\n            \n            // NOTE: 加入房间连麦\n            tiago.joinRTCForGameRoom(room);\n\n            // 交由 room_manager 进行管理\n            roomManager.loadRoom(room);\n        });\n        \n        match.on('error', error => {\n            console.log(error);\n        });\n    },\n});"]}